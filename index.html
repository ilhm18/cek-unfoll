<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cek unfoll instagram</title>
    <style>
      :root {
        --bg-1: #06070a;
        --bg-2: #0f1724;
        --card: rgba(255, 255, 255, 0.03);
        --muted: #9fb0c8;
        --text: #e6f0ff;
        --accent: #7c5cff;
        --accent-2: #3ad7ff;
        --glass-border: rgba(255, 255, 255, 0.06);
      }

      /* Improved result table styling */
      .table-wrap {
        margin-top: 12px;
        /* allow horizontal scroll when needed but keep visual blending */
        overflow: auto;
        border-radius: 8px;
        background: transparent;
        border: none;
      }
      /* Mobile card list (used when viewport is narrow) - visually joined */
      .card-list {
        display: flex;
        flex-direction: column;
        gap: 0; /* zero gap so items appear connected */
        margin-top: 8px;
        background: transparent; /* let .result-card provide background */
        border: none;
        border-radius: 8px;
        overflow: hidden;
      }
      .card-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 14px;
        background: transparent; /* let .result-card provide background */
        border-bottom: 1px solid rgba(255, 255, 255, 0.03);
      }
      .card-item:first-child {
        border-top: none;
      }
      .card-item:last-child {
        border-bottom: none;
      }
      .card-item .no {
        min-width: 44px;
        text-align: center;
        color: var(--muted);
        font-weight: 600;
      }
      .card-item .user {
        flex: 1;
        padding-left: 12px;
        font-weight: 700;
        word-break: break-word;
      }
      #result table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        background: transparent; /* blend with result card */
        color: var(--text);
      }
      /* Result card to visually separate the results from page background */
      .result-card {
        /* softer, more integrated card */
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.015),
          rgba(255, 255, 255, 0.006)
        );
        background-color: var(--card);
        border: 1px solid rgba(124, 92, 255, 0.04);
        border-radius: 10px;
        padding: 14px;
        box-shadow: 0 6px 18px rgba(2, 6, 23, 0.28);
        margin-top: 12px;
        backdrop-filter: blur(4px) saturate(1.02);
      }
      .result-card h2 {
        margin: 0 0 12px 0;
        font-size: 1.15rem;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 10px;
      }
      /* links in results */
      .result-card a {
        color: var(--accent-2);
        text-decoration: none;
      }
      .result-card a:hover {
        color: var(--accent);
        text-decoration: underline;
      }
      #result thead th {
        text-align: left;
        padding: 12px 16px;
        font-weight: 700;
        color: var(--muted);
        background: rgba(255, 255, 255, 0.01);
        border-bottom: 1px solid rgba(255, 255, 255, 0.02);
      }
      #result tbody td {
        padding: 12px 16px;
        vertical-align: middle;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.03);
      }
      #result tbody tr:nth-child(odd) td {
        background: rgba(255, 255, 255, 0.01);
      }
      #result tbody tr:hover td {
        background: rgba(124, 92, 255, 0.04);
      }
      #result td:first-child {
        width: 56px;
        text-align: center;
        color: var(--muted);
      }
      #result td:nth-child(2) {
        font-weight: 600;
      }
      @media (max-width: 420px) {
        #result thead th,
        #result tbody td {
          padding: 10px 12px;
          font-size: 0.95rem;
        }
      }
      html,
      body {
        height: 100%;
        margin: 0;
        background: radial-gradient(
            1200px 600px at 10% 10%,
            rgba(124, 92, 255, 0.1),
            transparent 8%
          ),
          radial-gradient(
            1000px 500px at 90% 90%,
            rgba(58, 215, 255, 0.06),
            transparent 8%
          ),
          linear-gradient(180deg, var(--bg-1), var(--bg-2));
        color: var(--text);
        font-family: Inter, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        padding: 32px;
        padding-bottom: 120px; /* ensure page content isn't hidden behind fixed footer */
        box-sizing: border-box;
      }

      .container {
        max-width: 820px;
        margin: 24px auto;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        border-radius: 14px;
        padding: 36px;
        box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(6px) saturate(1.1);
      }

      h1 {
        font-size: 34px;
        margin: 6px 0 14px 0;
        letter-spacing: -0.5px;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 10px;
        text-align: center;
        justify-content: center;
      }

      p,
      li,
      strong {
        color: var(--muted);
        line-height: 1.5;
      }

      code {
        background: rgba(255, 255, 255, 0.03);
        padding: 3px 6px;
        border-radius: 6px;
        color: var(--text);
        font-size: 0.95em;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }

      /* file input: keep it compact and prevent it from stretching table columns
         allow truncation of long filenames and ensure it fits the parent container */
      input[type="file"] {
        display: inline-block;
        width: 100%;
        max-width: 100%;
        min-width: 0; /* allow shrinking inside flex or table cells */
        margin: 12px 0;
        padding: 8px 10px;
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 8px;
        outline: none;
        cursor: pointer;
        box-sizing: border-box;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      button {
        background: linear-gradient(90deg, var(--accent), var(--accent-2));
        color: #061022;
        font-weight: 600;
        padding: 10px 16px;
        border: none;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(124, 92, 255, 0.16);
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s;
        margin-top: 8px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 28px rgba(124, 92, 255, 0.18);
        opacity: 0.98;
      }

      #result {
        margin-top: 22px;
        color: var(--text);
      }

      /* helper: small instruction link under the main button */
      .how-get {
        margin-top: 8px;
        font-size: 0.95rem;
        color: var(--muted);
        text-align: center;
      }
      .how-get a {
        color: var(--accent-2);
        font-weight: 700;
        text-decoration: none;
        margin-left: 6px;
      }
      .how-get a:hover {
        text-decoration: underline;
        color: var(--accent);
      }

      /* DM link in the helper box: show bold link without underline
         only the handle is clickable and styled; underline appears on hover */
      #how-get-files .dm-link {
        text-decoration: none;
        font-weight: 800;
        color: var(--accent-2);
        border-bottom: none;
      }
      #how-get-files .dm-link:hover {
        text-decoration: underline;
        color: var(--accent);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
        color: var(--text);
        font-size: 0.95rem;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          transparent
        );
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }

      th,
      td {
        padding: 12px 14px;
        text-align: left;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.03);
        /* prevent long inline elements (like file input UI or links) from widening the column */
        overflow: hidden;
        text-overflow: ellipsis;
        min-width: 0; /* allow shrinking in flexible layouts */
        word-break: break-word;
      }

      th {
        color: var(--muted);
        font-weight: 600;
        font-size: 0.9rem;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          rgba(255, 255, 255, 0.005)
        );
      }

      tr:last-child td {
        border-bottom: none;
      }

      .badge {
        display: inline-block;
        padding: 4px 8px;
        background: rgba(124, 92, 255, 0.12);
        color: var(--accent);
        border-radius: 999px;
        font-weight: 600;
        font-size: 0.85rem;
      }

      @media (max-width: 560px) {
        .container {
          padding: 20px;
        }
        h1 {
          font-size: 22px;
        }
        th,
        td {
          padding: 10px 8px;
        }
      }
      /* Footer styles */
      /* Make footer fixed and always visible while scrolling results */
      .site-footer {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        display: flex;
        justify-content: center;
        z-index: 9999;
        pointer-events: auto;
      }
      .site-footer > .footer-inner {
        /* full-width thin horizontal footer */
        max-width: none;
        width: 100%;
        margin: 0;
        border-radius: 0;
        /* subtle, thinner accent line */
        border-top: 1px solid rgba(124, 92, 255, 0.18);
        background: #23232a;
        color: var(--muted);
        /* compact layout: even smaller padding and text */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        /* slightly lower height but restore readable text size */
        padding: 3px 8px; /* slightly smaller vertical space */
        font-size: 13px; /* restored */
        line-height: 1.1;
        text-align: center;
        box-sizing: border-box;
      }
      /* keep the clickable IG link compact and centered */
      .site-footer .ig-link {
        display: inline-flex;
        align-items: center;
        gap: 4px !important; /* override inline gap if present */
        text-decoration: none;
      }
      .site-footer .ig-link img {
        /* slightly larger icon for readability but still compact; override inline */
        height: 16px !important;
        width: 16px !important;
        vertical-align: middle;
        margin: 0;
      }
      .site-footer .ig-link-text {
        color: var(--accent-2);
        font-weight: 700;
        font-size: 13px !important; /* restore readable size */
      }
      /* reduce spacing below the logo/link wrapper (overrides inline margin) */
      .site-footer > .footer-inner > div {
        margin-bottom: 2px !important;
      }
      .site-footer .footer-inner p,
      .site-footer .footer-inner span {
        margin-top: 2px !important;
        color: var(--muted);
        font-size: 12px !important; /* restore copyright size */
      }
      .site-footer a {
        color: var(--accent-2);
        text-decoration: none;
        font-weight: 700;
        margin-left: 6px;
      }
      .site-footer a:hover {
        text-decoration: underline;
        color: var(--accent);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>🔍 CEK UNFOLLOWER INSTAGRAM</h1>
      <p><center><strong>created by ilhamm</a></strong></center></p>
      <p>
        <strong>Langkah:</strong><br />
        1️⃣ Upload file <code>following.html</code><br />
        2️⃣ Upload file <code>followers_1.html</code><br />
        3️⃣ Klik tombol <b>Cek Sekarang</b>
      </p>

      <input type="file" id="followingFile" accept=".html" />
      <input type="file" id="followersFile" accept=".html" />
      <button onclick="checkUnfollowers()">Cek Sekarang</button>

      <p class="how-get">
        <h1></h1>cara mendapatkan filenya, <a href="#" id="show-how-link"> klik disini</a>
      <div
        id="how-get-files"
        style="
          display: none;
          margin-top: 8px;
          color: var(--muted);
          font-size: 0.95rem;
          max-width: 720px;
          margin-left: auto;
          margin-right: auto;
        "
      >
        <styl="padding-left: 18px; margin: 0">
          <li>
            Buka Aplikasi <strong>Instagram</strong> dan masuk ke <strong>profile</strong> anda.
          </li>
          <li>
            Buka settings <strong>Pusat Akun</strong>, lalu cari Informasi dan izin anda &gt;
            <em>Ekspor informasi Anda</em> (Buat ekspor) dan pilih profile anda
          </li>
          <li>
           <strong>Ekspor ke perangkat anda</strong> kemudian atur Rentang tanggal (saran sepanjang waktu)
          </li>
          <li>Dan klik tombol <strong>Mulai ekspor</strong></li>
          <li>Lalu tunggu hingga beberapa menit sampai notifikasi email dari instagram</li>
          <li>Jika sudah ada notifikasi, kembali ke <strong>Halaman ekspor</strong> yang sebelumnya dan <em>download</em> file informasinya</li>
          <li>Kemudian ekstrak File zip yang di download</li>
          <li>Lalu cari file <code>following.html</code>dan <code>followers_1.html</code></li>
          <li>
           Setelah itu Upload kedua file tersebut di form di atas, lalu klik
            <strong>Cek Sekarang</strong>.
          </li>
          <p>#harap perhatikan file <code>following.html</code> dan <code>followers_1.html</code> jangan sampai terbalik pada saat upload</p>
          <p>*Jika masih bingung Dm instagram <a href="https://instagram.com/ilhamm.18" class="dm-link" target="_blank" rel="noopener noreferrer">@ilhamm.18</a></p>
      </div>

      <div id="result"></div>
    </div>

    <footer class="site-footer" aria-label="Footer">
      <div
        class="w-full text-center py-6 footer-inner"
        style="background: #23232a; font-weight: 600"
      ></div>
    </footer>

    <script>
      // Read HTML file and return parsed Document
      async function readHTMLFile(file) {
        const text = await file.text();
        const parser = new DOMParser();
        return parser.parseFromString(text, "text/html");
      }

      // Try to extract likely usernames from a parsed HTML Document.
      // This function uses several heuristics and falls back to anchors/h2/li text.
      function extractUsernames(doc) {
        const names = new Set();

  // usernames we explicitly want to ignore (common placeholders / artifacts)
  // added exact exclusions for 'u' and 'followingprofiles' per user request
  const IGNORED = new Set(["_u", "_", "u", "followingprofiles"]);

        const isLikelyUsername = (s) => /^[A-Za-z0-9._]{1,30}$/.test(s);

        const push = (s) => {
          if (!s) return;
          s = s.replace(/^@/, "").trim();
          // basic validation: usernames are usually 1-30 chars, letters, numbers, dot, underscore
          const cleaned = s.split("\n")[0].trim();
          const lower = cleaned.toLowerCase();
          if (!isLikelyUsername(cleaned)) return;
          if (IGNORED.has(lower)) return; // skip ignored artifacts like "_u"
          names.add(cleaned);
        };

        // 1) common Instagram export: h2 may contain username
        doc.querySelectorAll("h2").forEach((el) => push(el.textContent));

        // 2) Anchors that look like profile links (instagram.com/username or /username/)
        doc.querySelectorAll("a[href]").forEach((a) => {
          try {
            const href = a.getAttribute("href");
            // absolute links
            const m1 =
              href &&
              href.match(
                /instagram\.com\/(?:p\/|explore\/|account_linking\/)?@?([A-Za-z0-9._-]+)/i
              );
            if (m1 && m1[1]) return push(m1[1]);
            // path-only like /username/
            const m2 = href && href.match(/^\/?([A-Za-z0-9._-]{1,30})\/?$/);
            if (m2 && m2[1]) return push(m2[1]);
          } catch (e) {
            // ignore
          }
          // fallback: anchor text that looks like a username
          const txt = a.textContent && a.textContent.trim();
          if (txt && isLikelyUsername(txt)) push(txt);
        });

        // 3) list items or spans that may contain usernames
        doc.querySelectorAll("li, span, div").forEach((el) => {
          const txt = el.textContent && el.textContent.trim();
          if (txt && /^[@A-Za-z0-9._\s]{1,60}$/.test(txt)) {
            // take the first token that matches username pattern
            const token = txt
              .split(/\s+/)
              .find((t) => isLikelyUsername(t));
            if (token) push(token);
          }
        });

        // final defensive filter: remove any ignored entries
        return Array.from(names).filter((n) => !IGNORED.has(n.toLowerCase()));
      }

      // Main handler that compares two uploaded HTML files and shows accounts not following back
      async function checkUnfollowers() {
        const followingFile = document.getElementById("followingFile").files[0];
        const followersFile = document.getElementById("followersFile").files[0];
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "<p>Memproses data...</p>";

        if (!followingFile || !followersFile) {
          resultDiv.innerHTML =
            "<p style='color:red'>⚠️ Harap upload kedua file (following.html dan followers_1.html)</p>";
          return;
        }

        const [followingDoc, followersDoc] = await Promise.all([
          readHTMLFile(followingFile),
          readHTMLFile(followersFile),
        ]);

        const followingUsernames = extractUsernames(followingDoc).map((s) =>
          s.toLowerCase()
        );
        const followerUsernames = extractUsernames(followersDoc).map((s) =>
          s.toLowerCase()
        );

        // Use a set for faster lookup
        const followerSet = new Set(followerUsernames);

        const notFollowingBack = followingUsernames.filter(
          (u) => !followerSet.has(u)
        );

        if (notFollowingBack.length === 0) {
          resultDiv.innerHTML = "<p>🎉 Semua akun mengikuti kamu kembali!</p>";
          return;
        }

        // build improved result — use table on wide screens, stacked cards on narrow screens
        const isNarrow = window.innerWidth <= 640;
        let inner = `<h2>🚫 Akun yang Tidak Mengikuti Balik</h2>`;
        if (isNarrow) {
          inner += `<div class="card-list">`;
          notFollowingBack.forEach((u, i) => {
            const safeUser = String(u).trim();
            const profileUrl = `https://instagram.com/${encodeURIComponent(
              safeUser
            )}`;
            inner += `<div class="card-item"><div class="no">${
              i + 1
            }</div><div class="user"><a href="${profileUrl}" target="_blank" rel="noopener noreferrer">@${safeUser}</a></div></div>`;
          });
          inner += `</div>`;
        } else {
          inner += `<div class="table-wrap"><table aria-describedby="unfoll-summary"><thead><tr><th style="width:64px">No</th><th>Username</th></tr></thead><tbody>`;
          notFollowingBack.forEach((u, i) => {
            const safeUser = String(u).trim();
            const profileUrl = `https://instagram.com/${encodeURIComponent(
              safeUser
            )}`;
            inner += `<tr><td style="text-align:center">${
              i + 1
            }</td><td><a href="${profileUrl}" target="_blank" rel="noopener noreferrer">@${safeUser}</a></td></tr>`;
          });
          inner += `</tbody></table></div>`;
        }
        inner += `<p id="unfoll-summary" style="color:var(--muted);margin-top:8px;">Total: ${notFollowingBack.length} akun</p>`;

        // Wrap result into a card to separate from page background
        const html = `<div class="result-card">${inner}</div>`;
        resultDiv.innerHTML = html;
      }

      // toggle helper instructions visibility
      const showHowLink = document.getElementById("show-how-link");
      if (showHowLink) {
        showHowLink.addEventListener("click", function (e) {
          e.preventDefault();
          const box = document.getElementById("how-get-files");
          if (!box) return;
          if (box.style.display === "none" || box.style.display === "") {
            box.style.display = "block";
            showHowLink.textContent = " tutup";
          } else {
            box.style.display = "none";
            showHowLink.textContent = " klik disini";
          }
        });
      }
    </script>
  </body>
</html>
