<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cek unfoll instagram</title>
    <style>
      :root {
        --bg-1: #06070a;
        --bg-2: #0f1724;
        --card: rgba(255, 255, 255, 0.03);
        --muted: #9fb0c8;
        --text: #e6f0ff;
        --accent: #7c5cff;
        --accent-2: #3ad7ff;
        --glass-border: rgba(255, 255, 255, 0.06);
      }

      /* Improved result table styling */
      .table-wrap {
        margin-top: 12px;
        overflow-x: auto;
        border-radius: 8px;
        -webkit-overflow-scrolling: touch;
      }
      #result table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          transparent
        );
        color: var(--text);
      }
      #result thead th {
        text-align: left;
        padding: 12px 16px;
        font-weight: 700;
        color: var(--muted);
        background: rgba(255, 255, 255, 0.02);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      }
      #result tbody td {
        padding: 12px 16px;
        vertical-align: middle;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.03);
      }
      #result tbody tr:nth-child(odd) td {
        background: rgba(255, 255, 255, 0.01);
      }
      #result tbody tr:hover td {
        background: rgba(124, 92, 255, 0.04);
      }
      #result td:first-child {
        width: 56px;
        text-align: center;
        color: var(--muted);
      }
      #result td:nth-child(2) {
        font-weight: 600;
      }
      @media (max-width: 420px) {
        #result thead th,
        #result tbody td {
          padding: 10px 12px;
          font-size: 0.95rem;
        }
      }
      html,
      body {
        height: 100%;
        margin: 0;
        background: radial-gradient(
            1200px 600px at 10% 10%,
            rgba(124, 92, 255, 0.1),
            transparent 8%
          ),
          radial-gradient(
            1000px 500px at 90% 90%,
            rgba(58, 215, 255, 0.06),
            transparent 8%
          ),
          linear-gradient(180deg, var(--bg-1), var(--bg-2));
        color: var(--text);
        font-family: Inter, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        padding: 32px;
        box-sizing: border-box;
      }

      .container {
        max-width: 820px;
        margin: 24px auto;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0.01)
        );
        border-radius: 14px;
        padding: 36px;
        box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(6px) saturate(1.1);
      }

      h1 {
        font-size: 34px;
        margin: 6px 0 14px 0;
        letter-spacing: -0.5px;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 10px;
        text-align: center;
        justify-content: center;
      }

      p,
      li,
      strong {
        color: var(--muted);
        line-height: 1.5;
      }

      code {
        background: rgba(255, 255, 255, 0.03);
        padding: 3px 6px;
        border-radius: 6px;
        color: var(--text);
        font-size: 0.95em;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }

      input[type="file"] {
        display: block;
        width: 100%;
        max-width: 360px;
        margin: 12px 0;
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 8px;
        outline: none;
        cursor: pointer;
      }

      button {
        background: linear-gradient(90deg, var(--accent), var(--accent-2));
        color: #061022;
        font-weight: 600;
        padding: 10px 16px;
        border: none;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(124, 92, 255, 0.16);
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s;
        margin-top: 8px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 28px rgba(124, 92, 255, 0.18);
        opacity: 0.98;
      }

      #result {
        margin-top: 22px;
        color: var(--text);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 12px;
        color: var(--text);
        font-size: 0.95rem;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          transparent
        );
        border-radius: 8px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.03);
      }

      th,
      td {
        padding: 12px 14px;
        text-align: left;
        border-bottom: 1px dashed rgba(255, 255, 255, 0.03);
      }

      th {
        color: var(--muted);
        font-weight: 600;
        font-size: 0.9rem;
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.01),
          rgba(255, 255, 255, 0.005)
        );
      }

      tr:last-child td {
        border-bottom: none;
      }

      .badge {
        display: inline-block;
        padding: 4px 8px;
        background: rgba(124, 92, 255, 0.12);
        color: var(--accent);
        border-radius: 999px;
        font-weight: 600;
        font-size: 0.85rem;
      }

      @media (max-width: 560px) {
        .container {
          padding: 20px;
        }
        h1 {
          font-size: 22px;
        }
        th,
        td {
          padding: 10px 8px;
        }
      }
      /* Footer styles */
      .site-footer {
        max-width: 820px;
        margin: 18px auto 40px auto;
        text-align: center;
        color: var(--muted);
        font-size: 0.92rem;
        padding-top: 12px;
        border-top: 1px solid rgba(255, 255, 255, 0.03);
      }
      .site-footer a {
        color: var(--accent-2);
        text-decoration: none;
        font-weight: 700;
        margin-left: 6px;
      }
      .site-footer a:hover {
        text-decoration: underline;
        color: var(--accent);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîç CEK UNFOLLOWER INSTAGRAM</h1>

      <p>
        <strong>Langkah:</strong><br />
        1Ô∏è‚É£ Upload file <code>following.html</code><br />
        2Ô∏è‚É£ Upload file <code>followers_1.html</code><br />
        3Ô∏è‚É£ Klik tombol <b>Cek Sekarang</b>
      </p>

      <input type="file" id="followingFile" accept=".html" />
      <input type="file" id="followersFile" accept=".html" />
      <button onclick="checkUnfollowers()">Cek Sekarang</button>

      <div id="result"></div>
    </div>

    <footer class="site-footer" aria-label="Footer">
      <div
        class="w-full text-center py-6"
        style="
          background: #23232a;
          color: #ffd166;
          font-weight: 600;
          border-top: 2px solid #ffd166;
        "
      >
        <div style="margin-bottom: 12px">
          <a
            href="https://instagram.com/ilhamm.18"
            target="_blank"
            rel="noopener noreferrer"
            style="
              display: inline-flex;
              align-items: center;
              gap: 8px;
              text-decoration: none;
              color: #7f5af0;
              font-weight: 600;
            "
            class="ig-link"
          >
            <img
              src="public/igeh.png"
              alt="Instagram"
              style="
                height: 28px;
                width: 28px;
                vertical-align: middle;
                filter: drop-shadow(0 2px 8px rgba(127, 90, 240, 0.18));
              "
            />
            <span class="ig-link-text">Follow me on Instagram</span>
          </a>
        </div>
        &copy; <span id="footer-year">2025</span> by ilham ‚Äî All rights
        reserved.
      </div>
    </footer>

    <script>
      // Read HTML file and return parsed Document
      async function readHTMLFile(file) {
        const text = await file.text();
        const parser = new DOMParser();
        return parser.parseFromString(text, "text/html");
      }

      // Try to extract likely usernames from a parsed HTML Document.
      // This function uses several heuristics and falls back to anchors/h2/li text.
      function extractUsernames(doc) {
        const names = new Set();

        const push = (s) => {
          if (!s) return;
          s = s.replace(/^@/, "").trim();
          // basic validation: usernames are usually 1-30 chars, letters, numbers, dot, underscore
          const cleaned = s.split("\n")[0].trim();
          if (/^[A-Za-z0-9._]{1,30}$/.test(cleaned)) names.add(cleaned);
        };

        // 1) common Instagram export: h2 may contain username
        doc.querySelectorAll("h2").forEach((el) => push(el.textContent));

        // 2) Anchors that look like profile links (instagram.com/username or /username/)
        doc.querySelectorAll("a[href]").forEach((a) => {
          try {
            const href = a.getAttribute("href");
            // absolute links
            const m1 =
              href &&
              href.match(
                /instagram\.com\/(?:p\/|explore\/|account_linking\/)?@?([A-Za-z0-9._]+)/i
              );
            if (m1 && m1[1]) return push(m1[1]);
            // path-only like /username/
            const m2 = href && href.match(/^\/?([A-Za-z0-9._]{1,30})\/?$/);
            if (m2 && m2[1]) return push(m2[1]);
          } catch (e) {
            // ignore
          }
          // fallback: anchor text that looks like a username
          const txt = a.textContent && a.textContent.trim();
          if (txt && /^[A-Za-z0-9._]{1,30}$/.test(txt)) push(txt);
        });

        // 3) list items or spans that may contain usernames
        doc.querySelectorAll("li, span, div").forEach((el) => {
          const txt = el.textContent && el.textContent.trim();
          if (txt && /^[@A-Za-z0-9._\s]{1,60}$/.test(txt)) {
            // take the first token that matches username pattern
            const token = txt
              .split(/\s+/)
              .find((t) => /^[A-Za-z0-9._]{1,30}$/.test(t));
            if (token) push(token);
          }
        });

        return Array.from(names);
      }

      // Main handler that compares two uploaded HTML files and shows accounts not following back
      async function checkUnfollowers() {
        const followingFile = document.getElementById("followingFile").files[0];
        const followersFile = document.getElementById("followersFile").files[0];
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "<p>Memproses data...</p>";

        if (!followingFile || !followersFile) {
          resultDiv.innerHTML =
            "<p style='color:red'>‚ö†Ô∏è Harap upload kedua file (following.html dan followers_1.html)</p>";
          return;
        }

        const [followingDoc, followersDoc] = await Promise.all([
          readHTMLFile(followingFile),
          readHTMLFile(followersFile),
        ]);

        const followingUsernames = extractUsernames(followingDoc).map((s) =>
          s.toLowerCase()
        );
        const followerUsernames = extractUsernames(followersDoc).map((s) =>
          s.toLowerCase()
        );

        // Use a set for faster lookup
        const followerSet = new Set(followerUsernames);

        const notFollowingBack = followingUsernames.filter((u) => !followerSet.has(u));

        if (notFollowingBack.length === 0) {
          resultDiv.innerHTML = "<p>üéâ Semua akun mengikuti kamu kembali!</p>";
          return;
        }

        // build improved, responsive table
        let html = `<h2>üö´ Akun yang Tidak Mengikuti Balik</h2>`;
        html += `<div class="table-wrap"><table aria-describedby="unfoll-summary"><thead><tr><th>No</th><th>Username</th></tr></thead><tbody>`;
        notFollowingBack.forEach((u, i) => {
          const safeUser = String(u).trim();
          const profileUrl = `https://instagram.com/${encodeURIComponent(safeUser)}`;
          html += `<tr><td>${i + 1}</td><td><a href="${profileUrl}" target="_blank" rel="noopener noreferrer">@${safeUser}</a></td></tr>`;
        });
        html += `</tbody></table></div>`;
        html += `<p id="unfoll-summary" style="color:var(--muted);margin-top:8px;">Total: ${notFollowingBack.length} akun</p>`;

        resultDiv.innerHTML = html;
      }
    </script>
  </body>
</html>
